NEW
AUTO
REM Program must be run on a BBC Micro with a 65(C)02 Co-processor
LOMEM=&C000
HIMEM=&F800
ONERROR:ONERROROFF:P.:REPORT:P.'ERL:CLOSE#0:END

REM optional bit-flags
DATA 2

REM header
REM IL,CL,NL,RL,MX,R,TT,ln,LT,ML,TR
DATA 52,219,77,30,5,1,0,4,35,89,1

REM actions
DATA 100,47,487,308,129,287,10123,0
DATA 0,8,540,0,0,0,9068,8614
DATA 100,328,569,620,560,0,7858,9600
DATA 100,484,186,549,540,0,8458,9600
DATA 100,601,280,0,0,0,9000,0
DATA 100,862,882,608,288,20,231,11773
DATA 0,20,0,0,0,0,12152,0
DATA 100,602,881,880,0,0,7950,0
DATA 100,882,601,880,0,0,11100,0
DATA 100,49,15000,80,20,0,11908,12223
DATA 0,40,0,0,0,0,8703,600
DATA 100,20,0,0,0,0,12150,0
DATA 100,19,600,0,0,0,8164,756
DATA 100,20,0,0,0,0,12150,0
DATA 100,20,20,0,0,0,12227,12150
DATA 100,167,521,240,0,0,9000,0
DATA 100,604,0,0,0,0,9450,0
DATA 100,1021,180,200,0,0,9060,0
DATA 100,541,200,0,0,0,9000,0
DATA 100,188,208,228,628,600,8700,0
DATA 100,284,189,0,0,0,8464,0
DATA 100,69,244,60,40,20,8779,12150
DATA 100,544,120,0,0,0,9057,9600
DATA 750,906,0,0,0,0,1058,1360
DATA 907,4,0,0,0,0,0,0
DATA 1050,4,0,0,0,0,0,0
DATA 2858,284,540,0,0,0,1704,0
DATA 1211,521,268,260,240,800,9060,11112
DATA 762,248,482,901,920,900,1872,10123
DATA 0,8,400,0,0,0,10258,0
DATA 2261,482,521,268,240,0,1964,8700
DATA 2261,482,801,800,0,0,1815,8850
DATA 2261,482,521,269,0,0,2414,0
DATA 3611,801,521,441,260,800,8717,2759
DATA 3611,801,521,446,0,0,2868,0
DATA 3607,521,0,0,0,0,3000,0
DATA 4057,523,268,0,0,0,3172,3474
DATA 4057,523,269,0,0,0,3172,3774
DATA 2563,264,288,588,608,0,10123,0
DATA 0,8,29,0,0,0,3927,4273
DATA 0,8,29,0,0,0,10273,0
DATA 0,8,340,0,0,0,4418,8700
DATA 2564,264,288,348,588,608,1829,4563
DATA 166,42,160,0,0,0,8112,0
DATA 167,242,180,0,0,0,8112,0
DATA 164,22,20,0,0,0,8112,0
DATA 4069,322,0,0,0,0,3181,0
DATA 169,322,40,0,0,0,8112,8464
DATA 4070,262,0,0,0,0,3182,0
DATA 172,202,320,0,0,0,8112,0
DATA 172,122,520,0,0,0,8112,0
DATA 173,62,340,0,0,0,8112,0
DATA 4057,222,0,0,0,0,3183,0
DATA 4075,282,0,0,0,0,3184,0
DATA 2876,282,0,0,0,0,3928,0
DATA 2877,342,360,20,0,0,9312,0
DATA 4826,282,0,0,0,0,3928,0
DATA 5127,342,360,20,0,0,9312,0
DATA 4078,302,397,380,180,0,9312,3185
DATA 5430,143,457,140,400,420,10874,10950
DATA 0,440,620,0,0,0,11174,5435
DATA 4056,24,0,0,0,0,3181,0
DATA 5420,262,421,480,260,0,10812,0
DATA 4082,362,0,0,0,0,3187,0
DATA 1533,882,880,580,380,0,8910,11100
DATA 1533,382,380,0,0,0,7800,0
DATA 2733,881,880,380,280,0,8903,9000
DATA 2733,381,380,0,0,0,7950,0
DATA 184,404,500,0,0,0,1854,0
DATA 5733,383,424,620,0,0,8712,0
DATA 4083,383,629,0,0,0,3158,5700
DATA 4083,383,628,0,0,0,3188,0
DATA 4080,143,0,0,0,0,5850,0
DATA 6183,383,501,608,0,0,6041,0
DATA 6183,383,501,609,0,0,6042,0
DATA 6183,443,501,608,0,0,6041,0
DATA 6183,883,501,609,0,0,6042,0
DATA 4085,564,369,820,0,0,5435,11173
DATA 0,360,980,0,0,0,8774,0
DATA 6487,328,623,0,0,0,1093,0
DATA 6487,623,180,620,0,0,10864,1800
DATA 6488,183,180,620,0,0,10864,1800
DATA 4089,484,181,29,0,0,3194,6823
DATA 0,0,0,0,0,0,6921,7050
DATA 0,677,0,0,0,0,7200,0
DATA 2876,484,181,20,0,0,8721,5278
DATA 4089,484,181,28,0,0,6645,7423
DATA 0,677,0,0,0,0,7200,0
DATA 1541,484,677,181,660,0,1852,0
DATA 0,0,0,0,0,0,0,0
DATA 5441,661,566,560,0,0,5435,11100
DATA 4092,444,0,0,0,0,3200,0
DATA 6750,224,461,529,520,0,8712,10950
DATA 0,680,220,0,0,0,9300,0
DATA 6750,528,461,224,700,220,9312,0
DATA 4093,682,737,0,0,0,3201,0
DATA 6944,682,461,509,737,500,3252,8700
DATA 6944,702,508,461,737,480,8721,15300
DATA 2894,702,488,737,720,0,7812,5435
DATA 1544,702,488,737,720,0,7812,0
DATA 4844,721,444,720,740,0,8903,0
DATA 7544,742,10,0,0,0,1153,0
DATA 7544,742,11,460,0,0,8112,0
DATA 7694,742,0,0,0,0,15600,0
DATA 7846,742,463,460,460,0,1858,8850
DATA 0,0,0,0,0,0,0,0
DATA 1547,464,466,82,0,0,1155,0
DATA 1547,461,464,82,80,760,1859,7800
DATA 5432,561,362,780,0,0,7812,5435
DATA 4098,781,0,0,0,0,3256,0
DATA 4099,542,0,0,0,0,3257,16273
DATA 0,0,0,0,0,0,3259,16500
DATA 0,429,0,0,0,0,16650,0
DATA 0,228,0,0,0,0,16800,0
DATA 1511,542,429,229,800,420,7858,1800
DATA 1511,802,800,0,0,0,7812,0
DATA 7961,801,542,420,800,0,1860,8850
DATA 158,542,560,0,0,0,8112,0
DATA 8258,564,449,440,0,0,1858,0
DATA 4102,564,0,0,0,0,3263,16123
DATA 0,449,0,0,0,0,16314,0
DATA 0,448,0,0,0,0,17364,0
DATA 0,388,0,0,0,0,17400,0
DATA 0,168,0,0,0,0,17400,0
DATA 0,389,169,0,0,0,1350,0
DATA 5435,564,369,820,0,0,5435,11173
DATA 0,360,980,0,0,0,8774,0
DATA 4103,821,0,0,0,0,17668,0
DATA 4104,603,0,0,0,0,3269,10950
DATA 0,589,0,0,0,0,18073,0
DATA 0,289,0,0,0,0,18223,0
DATA 0,288,588,608,628,0,10123,0
DATA 0,9,0,0,0,0,18373,0
DATA 0,0,0,0,0,0,10200,0
DATA 3654,603,0,0,0,0,3000,0
DATA 3655,264,289,603,280,600,8753,1800
DATA 3657,1023,0,0,0,0,15600,0
DATA 3633,603,383,589,580,0,8712,10950
DATA 0,380,880,0,0,0,10800,0
DATA 2876,264,882,288,608,0,18450,0
DATA 8458,44,183,763,983,923,10950,0
DATA 0,963,823,760,980,960,8909,8917
DATA 0,9,0,0,0,0,18600,0
DATA 0,8,920,580,1000,0,9352,1868
DATA 5749,542,1001,1000,900,380,10858,1800
DATA 2909,564,168,0,0,0,18756,9450
DATA 2909,564,389,0,0,0,3927,4200
DATA 2909,564,428,0,0,0,18756,9450
DATA 2909,564,408,0,0,0,18756,9450
DATA 2909,564,449,220,0,0,1912,8700
DATA 2909,564,88,80,100,0,9058,18900
DATA 2909,564,108,100,120,380,9058,9073
DATA 0,0,0,0,0,0,19106,9600
DATA 1511,542,228,0,0,0,18756,9450
DATA 5408,564,448,440,220,0,9060,1800
DATA 8711,801,424,400,0,0,9012,0
DATA 1505,448,0,0,0,0,1157,17250
DATA 1505,564,88,380,540,380,8162,1800
DATA 1505,564,108,60,540,60,8162,1800
DATA 1505,564,128,480,540,480,8162,1800
DATA 5408,284,540,0,0,0,1704,0
DATA 7860,542,1023,180,1020,0,1858,7950
DATA 7833,542,1023,200,1020,380,8753,7962
DATA 4111,44,0,0,0,0,1821,3927
DATA 5762,901,0,0,0,0,19200,0
DATA 5749,542,921,160,920,900,8772,1800
DATA 7542,444,0,0,0,0,19200,0
DATA 9150,0,0,0,0,0,1885,0
DATA 199,542,560,0,0,0,8112,0
DATA 5435,564,0,0,0,0,3927,4200
DATA 1563,448,0,0,0,0,1157,17250
DATA 1563,564,88,380,540,380,8162,1800
DATA 1563,564,108,60,540,60,8162,1800
DATA 1563,564,128,480,540,480,8162,1800
DATA 214,144,260,0,0,0,8100,0
DATA 1544,464,469,720,740,0,7859,0
DATA 2894,464,469,720,740,0,7859,0
DATA 1544,464,468,740,720,0,8324,10123
DATA 0,8,460,460,0,0,10274,9000
DATA 2894,464,468,740,720,460,8324,11173
DATA 0,460,0,0,0,0,9012,5435
DATA 8280,403,400,140,0,0,10800,0
DATA 5430,143,140,400,0,0,10800,0
DATA 4069,44,906,914,183,900,11121,5379
DATA 169,44,20,0,0,0,8100,0
DATA 6515,328,623,0,0,0,1093,0
DATA 6515,623,180,620,0,0,10864,1800
DATA 9815,183,180,620,0,0,10864,1800
DATA 1547,762,467,760,0,0,7800,0
DATA 1541,662,660,0,0,0,7800,0
DATA 158,284,540,0,0,0,8100,0
DATA 9900,600,0,0,0,0,8164,756
DATA 4117,0,0,0,0,0,1821,450
DATA 4061,801,408,0,0,0,3280,0
DATA 4061,801,409,0,0,0,3281,0
DATA 8458,826,44,0,0,0,19800,0
DATA 8458,44,181,0,0,0,5383,0
DATA 2261,801,542,420,800,0,1860,8850
DATA 10083,381,0,0,0,0,19200,0
DATA 1544,722,720,0,0,0,7800,0
DATA 2876,601,0,0,0,0,1826,4200
DATA 2550,4,0,0,0,0,0,0
DATA 2899,542,0,0,0,0,20100,0
DATA 10200,0,0,0,0,0,2535,0
DATA 10500,424,0,0,0,0,1800,0
DATA 7800,0,0,0,0,0,20400,0
DATA 2894,682,489,0,0,0,1187,0
DATA 1544,682,489,0,0,0,1187,0
DATA 6944,466,682,0,0,0,20100,0
DATA 6750,466,0,0,0,0,20100,0
DATA 5420,561,426,0,0,0,1188,0
DATA 4050,308,186,0,0,0,1058,6600
DATA 5432,421,566,0,0,0,1188,0
DATA 4050,0,0,0,0,0,1821,3927
DATA 1569,0,0,0,0,0,9900,0
DATA 10800,0,0,0,0,0,9900,0
DATA 10950,0,0,0,0,0,9450,0
DATA 11170,0,0,0,0,0,10650,0
DATA 11250,0,0,0,0,0,20850,0
DATA 6750,404,0,0,0,0,1826,4078
DATA 23

REM vocab
DATA "AUT","ANY"
DATA "GO","NORTH"
DATA "*WALK","SOUTH"
DATA "*RUN","EAST"
DATA "*ENTE","WEST"
DATA "PUMP","UP"
DATA "STAR","DOWN"
DATA "FIND","PUMP"
DATA "UNCO","COCK"
DATA "*DISC","*WIND"
DATA "GET","*DOOR"
DATA "*TAKE","HOSE"
DATA "*GRAB","GAS"
DATA "*PICK","WARF"
DATA "*REMO","YOYO"
DATA "PUT","*BUIL"
DATA "*INSE","STAT"
DATA "TRAN","BOOT"
DATA "DROP","*CASH"
DATA "PUSH","STAI"
DATA "*PULL","PIPE"
DATA "*PRES","*PADL"
DATA "*FLIP","HOUS"
DATA "*LIFT","HARD"
DATA "CONN","*STOR"
DATA "*TAPE","CONS"
DATA "*ATTA","SWIT"
DATA "LOOK","TABL"
DATA "*EXAM","PILE"
DATA "*L","*TRAS"
DATA "*DESC","TOOL"
DATA "*READ","*BOX"
DATA "THRO","SAFE"
DATA "*CAST","BATT"
DATA "SLID","SHAC"
DATA "*MOVE","GLOV"
DATA "OPEN","*COMP"
DATA "*UNLO","ON"
DATA "FUEL","OFF"
DATA "*REFU","BOMB"
DATA "*FILL","*CANI"
DATA "CHEC","ENVE"
DATA "*TEST","MOUN"
DATA "LIGH","HOLE"
DATA "*FLAS","LINE"
DATA "DIG","*PHON"
DATA "CUT","PICK"
DATA "*SLIC","QUAR"
DATA "*HIT","PAPE"
DATA "*CHOP","CAR"
DATA "CLIM","*JET"
DATA "TIE","*TANK"
DATA "TO","DASH"
DATA "REPL","FORM"
DATA "*RECO","RADI"
DATA "CLOS","ANTE"
DATA "MAKE","*LEAD"
DATA "*MIX","CABL"
DATA "WASH","FUEL"
DATA "*RINS","BUTT"
DATA "*CLEA","TERM"
DATA "SAY","VAT"
DATA "*YELL","JUG"
DATA "*SCRE","OUT"
DATA "*TALK","SHED"
DATA "UNLI","FLAS"
DATA "SLEE","*LIGH"
DATA "CHAR","ME"
DATA "USE","*MYSE"
DATA "*WITH","INVE"
DATA "SWIM","GAME"
DATA "*WADE","KEY"
DATA "INVE","DUCT"
DATA "QUIT","*TAPE"
DATA "SAVE","HYDR"
DATA "HELP","SAND"
DATA "","JAR"
DATA "","*FLUI"

REM rooms
DATA 0,0,0,0,0,0,""
DATA 0,0,0,3,0,0,"Yoyodyne office"
DATA 0,0,0,0,0,0,"Basement Laboratory"
DATA 4,5,6,7,0,0,"*I'm at the corner of Main & Hickory"
DATA 18,3,27,27,0,0,"*I'm at the corner of Main & Mountain View"
DATA 3,12,11,0,0,0,"*I'm at a highway access ramp"
DATA 0,0,10,3,0,0,"*I'm on Hickory Ave"
DATA 0,0,3,15,0,0,"*I'm on Hickory Ave"
DATA 0,0,3,0,0,0,"Gas Station"
DATA 8,0,0,0,0,0,"Cashiers Booth"
DATA 0,0,0,6,0,0,"Cul-de-sac at East end of Hickory"
DATA 0,0,0,5,0,0,"field of tall grass"
DATA 0,0,12,12,0,0,"*I'm on a freeway"
DATA 7,0,0,0,0,0,"shed full of radio equipment"
DATA 0,24,0,0,0,0,"Mine Shaft"
DATA 0,0,7,0,0,0,"Cul-de-sac at West end of Hickory"
DATA 0,0,15,0,0,0,"living room of a large house"
DATA 0,0,4,0,0,0,"hardware store"
DATA 22,4,0,19,0,0,"*I'm at the east end of a parking lot"
DATA 20,0,18,0,0,0,"*I'm at the west end of a parking lot"
DATA 21,19,0,0,0,0,"*I'm on a beach"
DATA 0,20,22,0,0,0,"cold shallow lake"
DATA 0,18,0,21,0,0,"*I'm at the foot of a mountain"
DATA 0,0,0,0,0,22,"*I'm on a small mountain ledge"
DATA 14,0,0,0,0,0,"cavern inside the mountain"
DATA 0,0,20,0,0,0,"lifeguard shack"
DATA 0,10,0,0,0,0,"*I'm in the garage of a large house"
DATA 0,0,4,4,0,0,"*I'm behind the mountain on Mountain View"
DATA 0,0,0,0,0,0,"cockpit of the jet car"
DATA 0,0,0,0,0,0,""
DATA 0,0,0,0,0,0,"*I'm in the hereafter."

REM messages
DATA ""
DATA "I hear the bomb will explode in"
DATA "moves"
DATA "'Buckaroo Banzai'"
DATA "Adventure by Scott Adams & Phillip Case"
DATA "An atomic explosion erupts."
DATA "I'm fried Banzai."
DATA "I can't,"
DATA "there's no"
DATA "empty"
DATA "container"
DATA "I go thru door. Slam!!!"
DATA "O.K."
DATA "It does"
DATA "reach the gasoline."
DATA "I lose it in the tank."
DATA "It doesn't"
DATA "tape holds it"
DATA "attached to pump."
DATA "it won't stay"
DATA "In 2 words, connect to what?, i.e. CONNECT PIPE"
DATA "I see"
DATA "the hose is"
DATA "10"
DATA "ft long"
DATA "6"
DATA "nothing"
DATA "special"
DATA "happens"
DATA "Bomb acknowledges code"
DATA "The earth is safe again."
DATA "darkness"
DATA "it's padlocked."
DATA "their turned off."
DATA "a switch to the gas pumps."
DATA "something"
DATA "I got"
DATA "it's a key safe."
DATA "water in the battery."
DATA "Sticker says: Sam's Service Station."
DATA "Battery tests:"
DATA "Weak"
DATA "Dead"
DATA "batterys are dead"
DATA "light"
DATA "marked 'RFI Shield' is"
DATA "on"
DATA "a switch"
DATA "and an envelope"
DATA "off"
DATA "a ledge about 15' up with a small peak."
DATA "an underground phone line."
DATA "the line is severed."
DATA "while carrying anything."
DATA "To what?"
DATA "It's imbedded in rock"
DATA "Disarm Code: 1=Warfin 2=Yoyodyne"
DATA "The cockpit is"
DATA "open"
DATA "power terminals,"
DATA "a fuel tank and a jet engine"
DATA "connected by a hose."
DATA "Engine is idling."
DATA "starter button & glove compartment."
DATA "Fuel gauge reads"
DATA "closed"
DATA "full"
DATA "Fuel is made from"
DATA "gasoline, sand, quartz, catalyst."
DATA "a transmit switch"
DATA "There's no battery"
DATA "There's no antenna"
DATA "It's not working."
DATA "To transmit say 'TRANSMIT something'"
DATA "I can't do that...yet"
DATA "Car catches fire and blows up."
DATA "I drive to Main St for attempt to mountain"
DATA "I drive into mountain."
DATA "How?"
DATA "under stairs, I get it."
DATA "residue inside it."
DATA "it's clean."
DATA "No formula!"
DATA "is missing."
DATA "Not with these hands."
DATA "work"
DATA "Not to that."
DATA "it's still attached."
DATA "the key doesn't fit."
DATA "Scott won't let me."

REM objects
DATA "Staircase",2
DATA "Yoyodyne building",3
DATA "Gas Station",3
DATA "Hardware store",4
DATA "Quartz",23
DATA "Shed with antenna",7
DATA "Large house",10
DATA "Small toolbox/TOOL/",26
DATA "Mine shaft",24
DATA "Flashlight (on)/FLAS/",0
DATA "Large house",15
DATA "Gas Pumps",8
DATA "Cashiers Booth",8
DATA "Filler pipe to underground gas tank",8
DATA "Control Console",9
DATA "Trash Pile",9
DATA "Staircase going down",1
DATA "Table",1
DATA "Floor safe",0
DATA "Old car battery/BATT/",0
DATA "Open toolbox/TOOL/",0
DATA "Key/KEY/",0
DATA "Roll of duct tape/DUCT/",0
DATA "Climbers Pick/PICK/",17
DATA "Unlocked filler pipe",0
DATA "Hydrometer/HYDR/",17
DATA "Manual hand pump/PUMP/",17
DATA "Jet Car",19
DATA "Key/KEY/",0
DATA "Lifeguard shack",20
DATA "Small Ham radio/RADI/",25
DATA "Flashlight (off)/FLAS/",0
DATA "Bomb housing",24
DATA "Envelope/ENVE/",0
DATA "large hole",0
DATA "Another large hole",0
DATA "20 ft of phone line/LINE/",0
DATA "Phone line dangling from above",0
DATA "Quartz/QUAR/",0
DATA "Sheet of paper/PAPE/",0
DATA "Fuel hose/HOSE/",0
DATA "Formula/FORM/",0
DATA "Dashboard",28
DATA "Antenna lead",13
DATA "Battery attached to radio/BATT/",0
DATA "Empty chemical Jug/JUG/",0
DATA "Jug of gasoline/JUG/",29
DATA "Mixing vat",2
DATA "Sand/SAND/",20
DATA "Jar of glowing Fluid/JAR/",0
DATA "Jug of jet fuel/JUG/",29
DATA "Jumper Cables/CABL/",17
DATA "Heavy stone door",14


RESTORE
CLS:INPUT"PREPARE DATA TAPE (HIT ENTER)";TP$:D=-1
CLS:PRINT"ADVENTURE DATA TAPE BUILDER - WORKING"
CLOSE#0:D=OPENOUT("DAT"):V.14

READ W%:PRINT#D,W%

READ IL,CL,NL,RL,MX,R,TT,ln,LT,ML,TR
PRINT#D,IL,CL,NL,RL,MX,R,TT,ln,LT,ML,TR
PRINT'"IL=";IL;",CL=";CL",NL=";NL;",RL=";RL;",MX=";MX;",R=";R","'"TT=";TT;",ln=";ln;",LT=";LT;",ML=";ML;",TR=";TR'
DIMCA%(0,7),NV$(NL,1),IA$(IL),IA(IL),RS$(RL),RM(RL,5),MS$(ML),AA(5),A$(9),A%(1,7):A$=STRING$(255,"*"):A$=""

P."-- CL -- CA%(1,7)"
FORZ=0TOCL:FORY=0TO7:READ CA%(0,Y):NEXTY:X=0:PRINT#D,CA%(X,0),CA%(X,1),CA%(X,2),CA%(X,3),CA%(X,4),CA%(X,5),CA%(X,6),CA%(X,7):PRINT';CA%(X,0);",";CA%(X,1);",";CA%(X,2);",";CA%(X,3);",";CA%(X,4);",";CA%(X,5);",";CA%(X,6);",";CA%(X,7):NEXTZ
READ Z:PRINT#D,Z:P.Z

OS."FX21":V.7,10,13,136:P."PRESS A KEY"':IFGET

P."-- NL -- NV$(NL,1)"
FORX=0TONL:FORY=0TO1:READ NV$(X,Y):P."NV$(";X;",";Y;")="NV$(X,Y):NEXTY,X
OS."FX21":V.7,10,13,136:P."PRESS A KEY"':IFGET

P."-- RL -- RM(RL,5), RS$(RL)"
FORX=0TORL:READ RM(X,0),RM(X,1),RM(X,2),RM(X,3),RM(X,4),RM(X,5),RS$(X)
P.;RM(X,0);" ";RM(X,1);" ";RM(X,2);" ";RM(X,3);" ";RM(X,4);" ";RM(X,5)'RS$(X):NEXT
OS."FX21":V.7,10,13,136:P."PRESS A KEY"':IFGET

P."-- ML -- MS$(ML)"
FORX=0TOML:READ A$
IF RIGHT$(A$,1)<>"[" MS$(X)=A$ ELSE MS$(X)=STRING$(255,"*"):MS$(X)=LEFT$(A$,(LENA$)-1):REP.READ A$:IF RIGHT$(A$,1)="[" MS$(X)=MS$(X)+LEFT$(A$,(LENA$)-1):U.0 EL.MS$(X)=MS$(X)+A$:U.1
P."MS$(";X;")="MS$(X):NEXT
OS."FX21":V.7,10,13,136:P."PRESS A KEY"':IFGET

P."-- IL -- IA$(IL)"
FORX=0TOIL:READ A$,IA(X):IA$(X)=A$:P."IA$(";X;")=";IA$(X)'"IA(";X;")=";IA(X):NEXT
OS."FX21":V.7,10,13,136:P."PRESS A KEY"':IFGET

P."Writing data to storage medium..."

FORX=0TONL:FORY=0TO1:PRINT#D,NV$(X,Y)
NEXTY,X

FORX=0TORL:PRINT#D,RM(X,0),RM(X,1),RM(X,2),RM(X,3),RM(X,4),RM(X,5),RS$(X)
NEXT

FORX=0TOML:PRINT#D,MS$(X)
NEXT

FORX=0TOIL:PRINT#D,IA$(X),IA(X)
NEXT

CLOSE#D
P.'"Finished writing data."'

INPUT"REWIND TAPE TO BE VERFIED";TP$

D=OPENIN("DAT")
RESTORE

READ W%:INPUT#D,Z:IF W%<>Z STOP

FORX=1TO11:READA0%:NEXT
INPUT#D,A0%,A1,A2,A3,A4,A5,A6,A7,A8,A9,B0
IFB0<>TR OR A0%<>IL OR A1<>CL OR A2<>NL OR A3<>RL OR A4<>MX OR A5<>R OR(A6<>TT) OR A7<>ln OR(A8<>LT) OR A9<>ML THEN STOP

FORX=0TOCL:INPUT#D,A%(0,0),A%(0,1),A%(0,2),A%(0,3),A%(0,4),A%(0,5),A%(0,6),A%(0,7)
FORZ=0TO7:READ A0%:IFA%(0,Z)<>A0% THEN STOP ELSE NEXT Z,X
READ A0%:INPUT#D,Z:IF A0%<>Z STOP

FORX=0TONL:FORY=0TO1:INPUT#D,A$(0):IFNV$(X,Y)<>A$(0) THEN STOP ELSE NEXTY,X

FORX=0TORL:INPUT#D,AA(0),AA(1),AA(2),AA(3),AA(4),AA(5),A$
FORY=0TO5:IFAA(Y)<>RM(X,Y)ORA$<>RS$(X)THEN STOP ELSE NEXT Y,X

FORX=0TOML:INPUT#D,A$
IFA$<>MS$(X)THEN STOP ELSE NEXT

FORX=0TOIL:INPUT#D,A$,AA(0)
IFAA(0)<>IA(X)ORA$<>IA$(X)THEN STOP ELSE NEXT

CLOSE#D:PRINT"DATA TAPE VERIFIED"

END


